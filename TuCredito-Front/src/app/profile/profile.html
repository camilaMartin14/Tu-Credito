<div class="profile-container">
  <div class="profile-card">
    <div class="profile-header">
      <div class="avatar">
        {{ authService.currentUser()?.nombre?.charAt(0) }}{{ authService.currentUser()?.apellido?.charAt(0) }}
      </div>
      <h2>{{ authService.currentUser()?.nombre }} {{ authService.currentUser()?.apellido }}</h2>
      <p class="role">Prestamista</p>
    </div>

    <!-- VIEW MODE -->
    <div class="profile-details" *ngIf="!isEditing">
      <div class="detail-item">
        <span class="label">Usuario</span>
        <span class="value">{{ authService.currentUser()?.usuario }}</span>
      </div>
      <div class="detail-item">
        <span class="label">Correo</span>
        <span class="value">{{ authService.currentUser()?.correo }}</span>
      </div>
      <div class="detail-item">
        <span class="label">Estado</span>
        <span class="value active" *ngIf="authService.currentUser()?.esActivo">Activo</span>
        <span class="value inactive" *ngIf="!authService.currentUser()?.esActivo">Inactivo</span>
      </div>
       <div class="detail-item">
        <span class="label">Fecha de Registro</span>
        <span class="value">No disponible</span>
      </div>
      
      <button class="edit-btn" (click)="toggleEdit()">Editar Perfil</button>
      <button class="logout-btn" (click)="logout()">Cerrar Sesión</button>
    </div>

    <!-- EDIT MODE -->
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" *ngIf="isEditing" class="profile-form">
      <div class="form-group">
        <label>Nombre</label>
        <input type="text" formControlName="nombre">
      </div>
      <div class="form-group">
        <label>Apellido</label>
        <input type="text" formControlName="apellido">
      </div>
      <div class="form-group">
        <label>Usuario</label>
        <input type="text" formControlName="usuario">
      </div>
      <div class="form-group">
        <label>Correo</label>
        <input type="email" formControlName="email">
      </div>
      <div class="form-group">
        <label>Contraseña Actual (para cambios)</label>
        <input type="password" formControlName="contraseniaActual" placeholder="Dejar en blanco si no cambia">
      </div>
      <div class="form-group">
        <label>Nueva Contraseña (opcional)</label>
        <input type="password" formControlName="nuevaContrasenia">
      </div>
      
      <div class="error-msg" *ngIf="error">{{ error }}</div>
      <div class="success-msg" *ngIf="message">{{ message }}</div>

      <div class="actions">
        <button type="button" class="cancel-btn" (click)="toggleEdit()">Cancelar</button>
        <button type="submit" class="save-btn" [disabled]="profileForm.invalid">Guardar Cambios</button>
      </div>
    </form>

  </div>
</div>
